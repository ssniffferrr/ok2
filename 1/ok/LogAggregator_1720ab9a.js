define(["OK/logger","OK/cookie"],(function(n,t){"use strict";var e,r,u,o,i="garbagelog";function l(t){var e=n.repository.getRequestData();e&&OK.sendBeacon("/gwtlog",e)}function a(){!1,l()}function c(n){var t=n.indexOf(".");return-1===t?n:n.substring(0,t)}function d(t,e,r,d,f,s,g){(function(t){if(!t)return!1;var e=c(t);return u.indexOf(e)>=0||(u.indexOf(i)>=0&&n.success(i,e),!1)})(t)&&(d&&!function(n){if(!n)return!1;var t=c(n),e=u.indexOf(t);return e>=0&&e<o}(t)&&(d=null),e?n.repository.addLog(t,parseInt(e,10),r,d,null,g[0],g[1]):n.repository.addLog(t,null,r,d,null,g[0],g[1]),f?l():s&&a())}function f(n,t,e,r,u){d(n,null,t,e,r,!1,u)}function s(n,e,r,u){var o;((o=t.readCookie("dme"))&&"true"===o.toLowerCase()||document.getElementById("__gwtd__m"))&&window.alert("Fatal Error '"+n+"'\nplace='"+r+"'\nerror name='"+u+"'\nCLOB='"+e+"'"),f(n,null,e,!0,[r,u])}function g(t){var e=parseInt(t.getAttribute("data-interval"),10)||1e3,i="true"===t.getAttribute("data-onbeforeunload");o=parseInt(t.getAttribute("data-clobslen"),10)||0,u=JSON.parse(t.firstChild.textContent),n.error=function(n,t){f("error","",null,!1,[t,n])},n.success=function(n,t,e){!function(n,t){d(n,null,null,null,!1,!1,t)}(n,[t,e])},n.force=function(n,t,e){!function(n,t){d(n,null,null,null,!1,!0,t)}(n,[t,e])},n.duration=function(n,t,e,r){!function(n,t,e){d(n,t,null,null,!1,!1,e)}(n,t,[e,r])},n.clob=s,n.raw=function(n,t,e,r){f(n,null,t,!1,[e,r])},n.replayQueue(),r=setInterval(a,e),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&l()})),i&&window.addEventListener("beforeunload",(function(){l()}),!1)}return{activate:function(n){e||(g(n),e=!0)},deactivate:function(){r&&(clearInterval(r),r=null)}}}));
//# sourceMappingURL=/res/source-maps/js/app/LogAggregator.js.map