define("OK/AjaxNavigationLog",["OK/logger"],(function(e){var t,n,r,i,o=!1;function a(e){if(e<0)return null;for(var t=[0,20,40,60,100,160,260,320,580,900],n=0;n<t.length-1;n++){var r=t[n],i=t[n+1];if(e>r&&e<=i)return r+"-"+i}return t[t.length-1]+"+"}function s(e,t){for(var n=t.substring(Math.max(0,t.indexOf("?")+1)).split("&"),r=0;r<n.length;r++){var i=n[r];if(0===i.indexOf(e+"="))return i.substr(e.length+1)}return""}return{log:function(i,c,l){if(o){var u=function(e){for(var n=s("st.cmd",e),r=s("cmd",e),i=0;i<t.length;i++){var o=t[i];if(o.indexOf("_")>-1){var a=o.split("_"),c=a[0],l=a[1];if("*"===c&&r===l)return l;if(n===c&&r===l)return n+"_"+r}else if(n===o)return o}return""}(c);if(u.length>0){e.duration("ajaxrequestdatatime.send.time",i,r+"_"+u,n);var d=(f=i)<100?1:(f>2e3&&(f=2e3),100*~~(f/100));d&&e.success("ad","ajax_"+r+"_"+u,d)}}var f;if(l){var g=l.split(":"),p=g[0],v=Number(g[1])/1e6,h=a(i),m=a(v);h&&m&&(e.success("ajaxrequestdatatime.client.measure",p,h),e.success("ajaxrequestdatatime.server.measure",p,m))}},activate:function(e){var a,s,c;i||(a=e.textContent,s=e.getAttribute("data-region"),c=e.getAttribute("data-countrycode"),n=s,r=c,t=JSON.parse(a),o=!0,i=!0)},deactivate:function(){t.length=0,n="",r="",i=!1}}})),define("OK/utils/screens",{apply:function(e){var t,n;"true"===document.body.getAttribute("data-uic")&&OK.getCurrentDesktopModelId&&(t=OK.getCurrentDesktopModelId(),OK.Layers&&OK.Layers.isAnyLayerOpened()&&(n=t,t=OK.Layers.getTopLayerId()),t&&e.setRequestHeader("OK-Screen",t),n&&e.setRequestHeader("OK-PrevScreen",n))}}),define("OK/utils/utils",["jquery","OK/logger","OK/AjaxNavigationLog","OK/utils/screens"],(function(e,t,n,r){"use strict";var i=document.getElementById("hook_Cfg_GwtExperimentsCfg"),o=i?OK.util.parseJSON(i.innerHTML):{},a="data-";function s(e,t,n){e.split(OK.navigation.SPLITER).forEach((function(e,t){n[t]&&OK.hookModel.setHookContent(n[t],e)}))}function c(r,i,o,a){var s=window.performance.now(),l=e.ajax(r);return a.xhr=l,a.fail((function(){l.abort()})),l.done((function(e,o,c){n.log(window.performance.now()-s,r.url,c.getResponseHeader("X-Render-Time")),e&&c.responseText&&0===e.length&&0!==c.responseText.length&&"[]"!=c.responseText&&(t.error("ajax",o),t.clob("ajax",JSON.stringify({requestData:r,response:c.responseText})));var l=c.getResponseHeader("TKN");l&&OK.tkn.set(l);var u=c.getResponseHeader("Redirect-Location");if(u)return i(u),void a.reject(c,o,"Redirect");OK.util.processCssHeaders(c).then((function(){a.resolve(e,o,c)}))})),l.fail((function(e,t,n){o>0?"timeout"!=t&&r.timeout?setTimeout((function(){c(r,i,--o,a)}),r.timeout):c(r,i,--o,a):a.reject(e,t,n)})),a}function l(e,t,n){var r=n.getResponseHeader(OK.navigation.HEADER);return r?r.split(","):null}function u(e){try{return e.getBoundingClientRect()}catch(e){return{top:0,right:0,bottom:0,left:0,width:0,height:0}}}return{ajax:function(t,n,i){arguments.length>1&&"function"!=typeof arguments[1]&&(i=n,n=void 0),i=i||0,n=n||function(e){OK.navigation.redirect?OK.navigation.redirect(e):document.location.href=decodeURIComponent(e)};var o=t.data||{},a=t.beforeSend;return t.type=t.type||"POST","POST"===t.type&&t.contentType&&-1!=t.contentType.indexOf("application/json")?"string"!=typeof o&&(o=JSON.stringify(o)):o["gwt.requested"]=window.pageCtx.gwtHash,t.data=o,t.beforeSend=function(e,t){e.setRequestHeader("TKN",OK.tkn.get()),e.setRequestHeader("STRD",OK.isStateRedesign()),r.apply(e),a&&a.apply(this,arguments)},c(t,n,i,e.Deferred())},getBlockIds:l,updateBlockModelCallback:function(e,t,n){var r=l(0,0,n);r&&s(e,0,r)},updateBlocks:s,gwtExperimentsCfg:o,removeTags:function(e){return"string"==typeof e?e.replace(/<[^>]*>/g,""):e},isElementInViewport:function(e){var t=u(e);if(t.top<0||t.left<0||t.bottom>window.innerHeight||t.right>window.innerWidth)return!1;var n=(t.right+t.left)/2,r=(t.bottom+t.top)/2;return e.contains(document.elementFromPoint(n,t.top))||e.contains(document.elementFromPoint(t.right,r))||e.contains(document.elementFromPoint(n,t.bottom))||e.contains(document.elementFromPoint(t.left,r))},isElementPartiallyInViewport:function(e,t,n){if(!t)return this.isElementInViewport(e);var r=u(e),i=Math.min(r.bottom,window.innerHeight)-Math.max(0,r.top),o=Math.min(r.right,window.innerWidth)-Math.max(0,r.left),a=e.offsetHeight,s=e.offsetWidth;return a||void 0===n?a*t<=i&&s*t<=o:!n&&null},isElementPartiallyInViewportWithOverlapCheck:function(e,t,n){var r=u(e);if(this.isElementPartiallyInViewport(e,t,n)){var i=(r.right+r.left)/2,o=(r.bottom+r.top)/2;return e.contains(document.elementFromPoint(i,r.top))||e.contains(document.elementFromPoint(r.right,o))||e.contains(document.elementFromPoint(i,r.bottom))||e.contains(document.elementFromPoint(r.left,o))}return!1},extendDeep:function(e){e=e||{};for(var t=1;t<arguments.length;t++){var n=arguments[t];if(n)for(var r in n)n.hasOwnProperty(r)&&("object"!=typeof n[r]||Array.isArray(n[r])?e[r]=n[r]:e[r]=this.extendDeep(e[r],n[r]))}return e},urlBase64ToUint8Array:function(e){for(var t=(e+function(e,t){var n="";for(;t-- >0;)n+=e;return n}("=",(4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r},deferred:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),resolve:e,reject:t}},getAttributesFromElement:function(e,t){"string"==typeof e&&(e=document.getElementById(e));for(var n={},r=0;r<e.attributes.length;r++){var i=e.attributes[r];0==i.name.indexOf(a)&&(n[i.name.substring(a.length)]=i.value)}return t&&e.parentNode.removeChild(e),n},getFormData:function(e,t){var n={},r=Array.prototype.slice.call(e.elements);return t&&(r=r.filter(t)),r.forEach((function(e){var t=e.name;if(t)switch(e.type){case"checkbox":n[t]=e.checked?"on":"off";break;case"radio":e.checked&&(n[t]=e.value);break;default:n[t]=e.value}})),n},parseJson:function(e){var t=e?e.replace(/<!--/gi,"").replace(/-->/gi,""):null;return t?JSON.parse(t):null},positiveId:function(){return OK.util.nextId()||OK.util.nextId()}}})),define("OK/utils/dom",[],(function(){"use strict";function e(e,t){if(e){if(11===e.nodeType){for(var n=[],r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];i.getElementsByClassName&&(n=n.concat(Array.prototype.slice.call(i.getElementsByClassName(t))))}return n}return Array.prototype.slice.call(e.getElementsByClassName(t))}return[]}function t(e,t,n,r){for(r||(e=e.parentElement);e;){if(t(e))return e;if(n&&n===e)return null;e=e.parentElement}return e}return{byClass:e,firstByClass:function(t,n){var r=e(t,n);return r.length?r[0]:null},querySelector:function(e,t){return e.querySelector(t)},querySelectorAll:function(e,t){return Array.prototype.slice.call(e.querySelectorAll(t))},parent:function(e,t,n,r){for(r||(e=e.parentElement);e;){if(!t||!e.classList||e.classList.contains(t))return e;if(n&&n===e)return null;e=e.parentElement}return e},traverseParents:t,getParentsAttrValue:function(e,n,r){var i=function(e){return e.getAttribute(n)},o=t(e,i,r,!0);return o?i(o):null},forEach:function(e,t){return Array.prototype.slice.call(e).forEach(t),e},innerHeight:function(e){try{return window.getComputedStyle(e,null).getPropertyValue("height")}catch(t){return e.currentStyle.height}},outerSize:function(e,t,n){var r;if("svg"===e.nodeName){var i=e.getBoundingClientRect();r=t?i.width:i.height}else r=t?e.offsetWidth:e.offsetHeight;if(null!==r){if(n){var o=window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle;r+=t?parseInt(o.marginLeft,10)+parseInt(o.marginRight,10):parseInt(o.marginTop,10)+parseInt(o.marginBottom,10)}return r}return 0},remove:function(e){var t;Array.isArray(e)||(e=[e]),e.forEach((function(e){(t=e.parentNode)&&t.removeChild(e)}))},one:function(e,t,n){e.addEventListener(t,(function e(t){return t.target.removeEventListener(t.type,e),n.call(this,t)}))},removeAllListeners:function(e){var t=e.cloneNode(!0);return e.parentNode.replaceChild(t,e),t}}})),define("OK/registration/StatesManager",[],(function(){"use strict";var e={relogin:{login:function(e){var t=e.getElementsByClassName("js-login-form")[0];t&&(t.elements["st.redirect"].value=null)}}};function t(e){this.root=e,this.states=[],this.activeStateId=null;for(var t=this.root.getElementsByClassName("js-login-state"),n=null,r=0;r<t.length;r++){var i=t[r],o=i.getAttribute("data-state-id");this.states.push({stateId:o,stateBlock:i,stateLink:e.getElementsByClassName("js-login-"+o)[0]}),i.classList.contains("invisible")||(n=o)}this.switchToState(n)}return t.prototype.executeStateToStateAction=function(t){var n=e[this.activeStateId];if(n){var r=n[t];"function"==typeof r&&r(this.root)}},t.prototype.switchToState=function(e){if(e!==this.activeStateId){for(var t=0;t<this.states.length;t++){var n=this.states[t];n.stateBlock.classList.toggle("invisible",e!==n.stateId),n.stateLink&&n.stateLink.classList.toggle("__active",e===n.stateId)}this.executeStateToStateAction(e),this.activeStateId=e}},t})),define("OK/registration/Registration",["OK/utils/utils","OK/utils/dom","OK/registration/StatesManager"],(function(e,t,n){"use strict";var r="js-login-nav";function i(){}return i.prototype.formHandler=function(t){t.preventDefault();for(var n={},r=0;r<this.form.elements.length;r++){var i=this.form.elements[r];n[i.name]=i.value}e.ajax({url:this.form.action,data:n}).done(e.updateBlockModelCallback)},i.prototype.navigationHandler=function(e){e.preventDefault();var n=t.parent(e.target,r,!1,!0),i=n.getAttribute("href");i&&(this.statesManager.switchToState(n.id.split("-")[0]),OK.historyManager.getState()!==i&&OK.historyManager.pushState(i),this.fixHeight())},i.prototype.fixHeight=function(){if(this.heightHolder){var e=this.heightHolder.clientHeight<320?320:this.heightHolder.clientHeight;this.heightHolder.style.minHeight=e+"px"}},i.prototype.activate=function(e){this.loginNavigation=t.byClass(e,r),this.form=t.firstByClass(e,"js-login-form"),this.statesManager=new n(e),this.boundNavigationHandler=this.navigationHandler.bind(this),this.boundFormHandler=null;var i="true"===e.getAttribute("data-modal");t.firstByClass(e,"js-st.field_fJS").value="on",t.firstByClass(e,"js-field_st.screenSize").value=screen.width+" x "+screen.height,t.firstByClass(e,"js-field_st.browserSize").value=window.innerHeight,t.firstByClass(e,"js-field_st.flashVer").value=(okFlashVersion||[]).join("."),i?(this.boundFormHandler=this.formHandler.bind(this),this.form.addEventListener("submit",this.boundFormHandler),OK.loader.use(["OKCustomJs"],(function(){OK.Layers.register("registration",(function(){OK.hookModel.setHookContent("PopLayer","")}),null,!1,null,null)}))):(this.heightHolder=t.parent(e,"anonym_login_w"),this.fixHeight());for(var o=0;o<this.loginNavigation.length;o++)this.loginNavigation[o].addEventListener("click",this.boundNavigationHandler)},i.prototype.deactivate=function(){this.boundFormHandler&&this.form.removeEventListener("submit",this.boundFormHandler);for(var e=0;e<this.loginNavigation.length;e++)this.loginNavigation[e].removeEventListener("click",this.boundNavigationHandler)},i})),define("OK/registration/RegistrationDesign21",["require","exports","OK/utils/dom"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="click",i="invisible",o=function(){var e=this;this.onClickLoginButton=function(){e.landingBlock.classList.toggle(i,!0),e.loginBlock.classList.toggle(i,!1)}};o.prototype.activate=function(e){this.goToLoginButton=n.firstByClass(e,"js-go-to-login-form"),this.landingBlock=n.firstByClass(e,"js-tab-landing"),this.loginBlock=n.firstByClass(e,"js-tab-login-form"),this.goToLoginButton.addEventListener(r,this.onClickLoginButton)},o.prototype.deactivate=function(){this.goToLoginButton.removeEventListener(r,this.onClickLoginButton)},t.default=o})),define("OK/registration/Utils",["OK/utils/utils"],(function(e){"use strict";var t=document.getElementById("generalErrorHook"),n=null,r={registration:{prefix:"st.r.",state:"anonymMain",cmd:"AnonymRegistration"},password:{prefix:"st.",state:"anonymPasswordRecoveryNew",cmd:"AnonymPasswordRecoveryNew"},account:{prefix:"st.",state:"anonymAccountRecoveryFlow",cmd:"AnonymAccountRecoveryFlow"}};return t&&(n=t.getAttribute("data-general"),t.parentNode.removeChild(t)),{lastSmsTimeCookieName:"_lastSmsForCodeTime_",addSubmitHook:function(e,t){e.addEventListener("keyup",(function(e){13==e.keyCode&&t()}))},getAttributesFromHook:e.getAttributesFromElement,proceed:function(t,i,o,a){var s={};for(var c in t)s[r[a].prefix+c]=t[c];var l={data:s,url:"/dk"};l.data["st.cmd"]=r[a].state,l.data.cmd=r[a].cmd,e.ajax(l).done(e.updateBlockModelCallback).fail((function(e,t,r){"Redirect"!=r&&o&&n&&(o.classList.remove("invisible"),o.textContent=n)}))},toggleClass:function(e,t,n){n?e.classList.add(t):e.classList.remove(t)},hideFieldError:function(e,t){e&&e.classList.remove("form_i__error"),t&&t.classList.remove("invisible")},showFieldError:function(e,t,n,r){n&&(n.textContent=r),e&&e.classList.add("form_i__error"),t&&t.classList.add("invisible")},getInputValue:function(e){return e?e.value:""},getValueForLog:function(e){return e>=100?e=100:e>=50?e=50:e>=25?e=25:e>=10&&(e=10),e},getActionByType:function(e){return"account"==e?"accountAction":"registrationAction"}}})),define("OK/cookie",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DAY_MS=t.storeCookie=t.clearCookie=t.readCookie=t.setCookie=void 0;var n=864e5;function r(e,t,r,i,o){var a="";if(r){r*=n;var s=new Date;s.setTime(s.getTime()+r),a=";expires="+s.toUTCString()}document.cookie=e+"="+encodeURIComponent(t)+a+(i?";path="+i:"")+(o?";domain="+o:"")}t.DAY_MS=n,t.setCookie=r,t.readCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1);if(i.startsWith(t))return i.substring(t.length)}return null},t.clearCookie=function(e,t){r(e,"",0,t)},t.storeCookie=function(e,t,n){document.cookie=e+"="+encodeURIComponent(t)+(n||"")}})),define("OK/registration/enterCode",["OK/registration/Utils","OK/utils/dom","OK/cookie"],(function(e,t,n){"use strict";return{activate:function(i){var o=i.parentNode,a=t.firstByClass(o,"js-general-error"),s=t.firstByClass(i,"js-back-to-enter-phone"),c=t.firstByClass(i,"js-proceed-registration"),l=t.firstByClass(i,"js-proceed-registration-container"),u=t.firstByClass(i,"js-resend-sms-code"),d=t.firstByClass(i,"js-resend-sms-code-disabled"),f=t.firstByClass(i,"js-resend-sms-code-container"),g=t.firstByClass(i,"js-sms-code"),p=d.value||d.innerHTML,v=i.getAttribute("data-type"),h=e.getActionByType(v),m=i.hasAttribute("data-code-expired"),y=e.lastSmsTimeCookieName+v,b=parseInt(i.getAttribute("data-resend-timeout"))||20,C=i.getAttribute("data-format-seconds")?r:function(e){return e},E=function(){if(g.value){var t={smsCode:g.value};t[h]="ValidateCode",e.proceed(t,o,a,v)}},O=function(){var e,t,r=parseInt(n.readCookie(y),10),i=Date.now();r||(r=i,n.setCookie(y,r,1,"/")),e=Math.round((i-r)/1e3),d.value=d.innerHTML=p.replace("%d",C(b-e)),e<=b?(d.classList.remove("invisible"),u.classList.add("invisible"),t=setInterval((function(){i=Date.now(),(e=Math.round((i-r)/1e3))<=b?d.value=d.innerHTML=p.replace("%d",C(b-e)):(clearInterval(t),d.classList.add("invisible"),u.classList.remove("invisible"),u.classList.remove("__disabled"))}),300)):(d.classList.add("invisible"),u.classList.remove("invisible"),u.classList.remove("__disabled"))};function w(){var t=""===g.value;l&&e.toggleClass(l,"invisible",t),f&&e.toggleClass(f,"invisible",!t),e.toggleClass(c,"__disabled",t)}u.addEventListener("click",(function(){var t={};t[h]="ResendCode",e.proceed(t,o,a,v),n.clearCookie(y,"/"),O()})),s&&s.addEventListener("click",(function(){e.proceed({registrationAction:"BackToEnterPhone"},o,a,v)})),m?(e.toggleClass(c,"__disabled",!0),d.classList.add("invisible"),u.classList.remove("invisible")):(c.addEventListener("click",E),e.addSubmitHook(g,E),g.addEventListener("keyup",w),g.addEventListener("input",w),g.addEventListener("cut",(function(){setTimeout(w,0)})),g.addEventListener("propertychange",(function(e){"value"==e.propertyName&&w()})),w(),O())}};function r(e){var t=parseInt(e/3600)%24,n=parseInt(e/60)%60,r=e%60;return(t>0?t+":":"")+(n<10?"0"+n:n)+":"+(r<10?"0"+r:r)}})),define("OK/registration/chooseUser",["OK/registration/Utils"],(function(e){"use strict";return{activate:function(t){var n,r,i=t.parentNode,o=i.getElementsByClassName("js-general-error")[0],a=t.getElementsByClassName("js-its-not-me-button")[0],s=i.getElementsByClassName("chooseUserButton"),c=e.getAttributesFromHook(t.getElementsByClassName("js-action-hook")[0],!0).action,l=t.getAttribute("data-type"),u=function(t){var n={userId:t.target.getAttribute("data-value"),registrationAction:"RecoverUser"};e.proceed(n,i,o,l)};if(s)for(n=0,r=s.length;n<r;n++)s[n].addEventListener("click",u);a&&a.addEventListener("click",(function(){var t={registrationAction:c};e.proceed(t,i,o,l)}))}}})),define("OK/registration/authorize",["OK/registration/Utils","OK/logger","OK/utils/dom"],(function(e,t,n){"use strict";return{activate:function(r){var i,o=r.parentNode,a=n.firstByClass(o,"js-general-error"),s=n.firstByClass(r,"js-proceed"),c=n.firstByClass(r,"js-enter-password"),l=n.firstByClass(r,"js-enter-login"),u=n.firstByClass(r,"js-support-link"),d=r.getAttribute("data-type"),f=e.getActionByType(d),g=r.getAttribute("data-enabled-log-timer"),p=r.getAttribute("data-validate-password-in-js")||!0,v=0;if(l){var h=e.getAttributesFromHook(n.firstByClass(r,"js-login-restrictions-hook"),!0),m=new RegExp(h["allowed-symbols-pattern"]),y=h["min-length"],b=n.firstByClass(r,"js-login-hint"),C=n.firstByClass(r,"js-login-form"),E=n.firstByClass(r,"js-login-error"),O=e.getAttributesFromHook(n.firstByClass(r,"js-hook-login-msg"),!0),w=function(t){var n=l.value;if(m.test(n)){if(t)return e.hideFieldError(C,b),!0;if(""==n)e.showFieldError(C,b,E,O.empty);else{if(!(n.length<y))return e.hideFieldError(C,b),!0;e.showFieldError(C,b,E,O.short)}}else e.showFieldError(C,b,E,O["invalid-characters"]);return!1};l.addEventListener("keyup",(function(){w(!0)}))}var L=n.firstByClass(r,"js-password-restrictions-hook");if(L){var A=e.getAttributesFromHook(L,!0),k=A["min-length"],T=new RegExp(A["allowed-symbols-pattern"]),x=new RegExp(A["must-contain-pattern"]),K=A["split-must-contain-pattern"],N=/[a-zA-Z]+/,_=/[0-9]+/,j=n.firstByClass(r,"js-password-error"),B=n.firstByClass(r,"js-password-form"),S=n.firstByClass(r,"js-password-indicator-container"),R=n.firstByClass(r,"js-password-rate"),I=R.getElementsByClassName("progress-rate_bar"),H=n.firstByClass(r,"js-password-indicator-hint"),P=e.getAttributesFromHook(n.firstByClass(r,"js-hook-pwd-msg"),!0),M=function(t,n,r){if(R.className="progress-rate mt-2x "+t,n>0)for(var i=0;i<n;i++)I[i].classList.add("__full");if(n<3)for(i=n;i<I.length;i++)I[i].classList.remove("__full");e.toggleClass(B,"form_i__error",r),e.toggleClass(H,"reg_error_txt",r)};i=function(t,n,r){if(!j||!r){if(j&&(e.toggleClass(B,"form_i__error",!0),e.toggleClass(S,"invisible",!1),j.parentNode.removeChild(j),j=null),""==t)H.textContent=P.empty,M("",0,n);else if(T.test(t)){if(!(t.length<k)&&x.test(t))return H.textContent=P.ok,M("__strong",3,!1),!0;t.length<k&&!x.test(t)?M("__weak",1,!0):M("__normal",2,!0),t.length<k?H.textContent=P.short:(H.textContent=P["must-contain"],"true"==K&&(N.test(t)?H.textContent=P["only-letters"]:_.test(t)&&(H.textContent=P["only-numbers"])))}else M("__weak",3,!0),H.textContent=P.invalid;return!1}}}else i=function(e,t,n){if(!j||!n)return!0};c.addEventListener("keyup",(function(){i(c.value,!0)}));var q=function(){var t=!0;if(l&&(t=w()),i(c.value,!0)&&t||"true"!=p){var n={password:c.value};n[f]="Authorize",l&&(n.login=l.value),u&&(n.splnk="on"),e.proceed(n,o,a,d)}};s.addEventListener("click",q),e.addSubmitHook(c,q),i(c.value,!1,!0);var F=function(){v+=1,t.success("recovery","ppot",e.getValueForLog(v)),setTimeout(F,3e5)};"recovery"==d&&"true"==g&&setTimeout(F,5)}}})),define("OK/registration/socialAuthHandler",[],(function(){"use strict";var e,t;function n(n,r){e&&t&&t==r&&e(n),window.socialAuthCallback=e=t=void 0}return{openWindow:function(r,i,o,a){window.socialAuthCallback=n,e=i,t=window.open(r,"","width="+o+" , height="+a)}}})),define("OK/utils/vanilla",["OK/AjaxNavigationLog","OK/utils/screens"],(function(e,t){"use strict";function n(e){var t=[],n=function(e,n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];Array.isArray(i)?i.forEach(n.bind(null,r)):n(r,e[r])}return t.join("&")}function r(r,i){var o=r.type||"POST",a=r.data||{},s=r.url||"",c=/^(https?:)?\/\//.test(s),l={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},u=r.headers||{},d={},f=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,g=r.beforeOpen,p=new XMLHttpRequest;if(i||(i=function(e){OK.navigation.redirect?OK.navigation.redirect(e):document.location.href=decodeURIComponent(e)}),"POST"===o&&"string"!=typeof a)if(r.isFileUpload){u["Content-Type"]="application/octet-stream";var v=(a.name||"1.jpg").replace(/[^\u0000-\u007F]+/gi,"_").substring(0,255);u["Content-Disposition"]='attachment; filename="'+v+'"'}else u["Content-Type"]="application/x-www-form-urlencoded",window.pageCtx.gwtHash&&(a["gwt.requested"]=window.pageCtx.gwtHash),a=n(a);r.contentType&&l.hasOwnProperty(r.contentType)&&!u.hasOwnProperty("Content-Type")&&(u["Content-Type"]=l[r.contentType]),r.dataType&&l.hasOwnProperty(r.dataType)&&!u.hasOwnProperty("Accept")&&(u.Accept="*"===r.dataType?l[r.dataType]:l[r.dataType]+", */*; q=0.01"),c||u.hasOwnProperty("TKN")||(u.TKN=OK.tkn.get()),c||u.hasOwnProperty("STRD")||(u.STRD=OK.isStateRedesign());var h=new Promise((function(n,l){var v=window.performance.now();for(var h in g&&g({xhr:p}),p.open(o,s,!0),u)u.hasOwnProperty(h)&&p.setRequestHeader(h,u[h]);c||t.apply(p),p.onreadystatechange=function(){if(p.readyState===XMLHttpRequest.HEADERS_RECEIVED){for(var t,o=p.getAllResponseHeaders();t=f.exec(o);)d[t[1].toLowerCase()]=t[2];if(!c&&d["redirect-location"])return i(d["redirect-location"]),void l(p,p.statusText,"Redirect")}if(p.readyState===XMLHttpRequest.DONE)if(p.status>=200&&p.status<300||304===p.status){e.log(window.performance.now()-v,s,p.getResponseHeader("X-Render-Time"));var a=p.responseText,u=a;if("json"===r.dataType)try{u=JSON.parse(a)}catch(e){l(e)}!c&&d.tkn&&OK.tkn.set(d.tkn),OK.util.processCssHeaders(p).then((function(){n({response:u,xhr:p})}))}else l(p)},p.onerror=function(){l(p)};var m=r.signal;m&&m.addEventListener("abort",(function(){p.abort(),l(p)})),p.send(a)}));return h.xhr=p,h}function i(e){var t=e.getResponseHeader(OK.navigation.HEADER);return t?t.split(","):null}function o(e,t){e.split(OK.navigation.SPLITER).forEach((function(e,n){t[n]&&OK.hookModel.setHookContent(t[n],e)}))}return{ajax:r,getJSON:function(e,t){return r({type:"GET",dataType:"json",url:e,data:t})},trigger:function(e,t,n){if(e&&3!==e.nodeType&&8!==e.nodeType){var r=document.createEvent("CustomEvent");r.initCustomEvent(t,!0,!0,n),e.dispatchEvent(r)}},encodeHtml:function(e){var t=document.createElement("div");return e.split(" ").map((function(e){return t.innerText=e,t.innerHTML})).join(" ")},extractParams:function(e){var t={},n=e&&e.indexOf("?");return n>-1&&e.substr(n+1).split("&").forEach((function(e){if(e.indexOf("=")>-1){var n=e.split("="),r=n[0],i=n[1];i=decodeURIComponent(i.replace(/\+/g,"%20")),t[r]=i}})),t},stringifyParams:n,getBlockIds:i,updateBlocks:o,updateBlockModelCallback:function(e){var t=i(e.xhr);t&&o(e.response,t)},getFormData:function(e){return Array.prototype.slice.apply(e.getElementsByTagName("input")).reduce((function(e,t){return t.name&&(e[t.name]="checkbox"===t.type?t.checked?"on":"off":t.value),e}),{})},unescapeXml:function(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'")},escapeXml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},formatNumber:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}}})),define("OK/webapi",["OK/utils/vanilla","OK/logger"],(function(e,t){"use strict";var n=0,r=!1,i="api.communication-error";function o(n,o,a){var s=function(e){return"/web-api/v2/"+e}(n),c=function(e){return JSON.stringify(e,null,2)}(o);return new Promise((function(n,o){var l=e.ajax({contentType:"application/json; charset=utf-8",url:s,dataType:"json",data:c}),u=l.xhr;function d(){u.abort(),r=!0,f(),o({type:2,typeName:"ABORT",errorCode:"abort",errorMessage:u.statusText||"abort"})}function f(){a.signal&&a.signal.removeEventListener("abort",d)}a.signal&&a.signal.addEventListener("abort",d),l.then((function(e){r=!1,f();var t=e.response;t.success?n(t.result):o(t.error)}),(function(e){r||t.error(i),f(),r=!0,o({type:200,typeName:"SERVER_ERROR",errorCode:i,errorMessage:e.statusText||i})}))}))}var a={invoke:function(e,t,r){var i={id:++n},a=(r=r||{}).filter;return null!=t&&(i.parameters=t),null!=a&&(i.filter=a),o(e,i,r)}};return"undefined"!=typeof window&&(window.webapi=a),a})),define("OK/capture",[],(function(){"use strict";var e,t=document,n=/(\?|\&)cmd=([^\&]+)/,r=null,i=function(e){return Array.prototype.slice.call(e)},o=function(e){var t=e.match(n);if(t)return t[2]},a=function(e,t){if(e&&"object"==typeof e){if(e.default)return e.default;if(e[t])return e[t]}return e},s=function(e,t){var n,i="OK/"+t;null!==r&&-1===r.indexOf(t)||(n=function(e,t){var n=e.getAttribute("data-activate")||"activate";return function(r){var i;"function"==typeof(r=a(r,t))?(i=new r(e.id,e),e.okReqModule=i):i=r,i[n](e)}}(e,t),require.defined(i)?n(require(i)):require([i],n))},c=function(e,t){var n="OK/"+t;if((null===r||-1!==r.indexOf(t))&&require.defined(n)){var i,o=e.getAttribute("data-deactivate")||"deactivate",s=require(n);"function"==typeof(s=a(s,t))?(i=e.okReqModule,e.okReqModule=null):i=s,i&&i[o]&&i[o](e)}},l=function(n,r){var a,l,u,d,f;for(a=i((n=n||t).getElementsByClassName("h-mod")),l=0;l<a.length;l+=1)(d=(u=a[l]).getAttribute("data-module"))&&(r?c(u,d):s(u,d));if(e)for(a=i(n.getElementsByTagName("a")),l=0;l<a.length;l+=1)if(f=(u=a[l]).getAttribute("href")){var g=o(f);g&&(d=e[g])&&(r?c(u,d):s(u,d))}},u=function(e){"interactive"===t.readyState||"complete"===t.readyState?l(e,!1):t.addEventListener("DOMContentLoaded",l)};return{setWhiteList:function(e){r=e},activate:u,activateDocument:function(t,n){var r,i,o,a;if(t&&t.length)for(e={},r=0;r<t.length;r+=1)o=(i=t[r].split(":"))[0],a=1===i.length?i[0]:i[1],e[o]=a;u()},deactivate:function(e){"interactive"!==t.readyState&&"complete"!==t.readyState||l(e,!0)}}})),define("OK/react-loader",["module","OK/logger","OK/capture"],(function(e,t,n){"use strict";var r=e.config().baseUrl||"/res/react",i=["REACT/vendors","REACT/core","OK/pts","OK/pms","OK/webapi","OK/css-loader","OK/LazyIconsCache"],o={INIT:"app-block:init",ACTIVATE:"app-block:activate",DEACTIVATE:"app-block:deactivate",ERROR:"app-block:error",REACT_ERROR:"app-block:react-error",LOG:"app-block:log",READY:"app-block:ready"},a="app-block-inited",s=function(){this.element=null,this.tagName="",this.appModule=null};function c(e){for(var t=(e||"").split(","),n=[],r=0,i=t.length;r<i;r++)t[r]&&n.push(t[r].trim());return n}function l(t){return require(t.modules,t.resolve,(function(n){var r=n.requireModules,i=e.config().retryRequireLoad||0,o=t.step||1,a=o<=i,s=a||e.config().alwaysUndefOnError;if(r&&s&&r.forEach((function(e){requirejs.undef(e)})),!r||!a)return d(t.tagName,t.error,function(e){var t=e.originalError||e;return{message:t.message||"",requireType:e.requireType,requireModules:e.requireModules,stack:t.stack||""}}(n)),void t.reject(n);l(Object.assign({},t,{modules:r,step:o+1}))}))}function u(e){return r+"/"+e}function d(e,n,r){console.error(e,n,r);var i=r;"object"==typeof r&&(i=Object.keys(r).map((function(e){var t=r[e];return e+"="+("string"==typeof t?t:JSON.stringify(t))})).join("\n")),t.clob("react-error",i,e,n)}function f(){return Math.floor(performance.now())}function g(e){return e<10?"0":e>5e3?"5000":(Math.floor(e)+"").split("").map((function(e,t){return t?"0":e})).join("")}return s.prototype.activate=function(e){this.element=e,this.tagName=e.tagName.toLowerCase(),this.activateStartTime=f();var t=this;if(!e)return Promise.reject(new Error("Element is not provided"));var n=e.getAttribute("data-react"),r=e.getAttribute("data-css"),o=c(e.getAttribute("data-l10n")),a=c(e.getAttribute("data-cfg")),s=c(e.getAttribute("data-require-modules"));return n?function(e,t,n,r,o,a){var s=["OK/react-loader!"+u(t)];n&&s.push("OK/css-loader!"+u(n));r.forEach((function(e){s.push("OK/pts!"+e)})),o.forEach((function(e){s.push("OK/pms!"+e)}));var c=i.concat(a||[]);return new Promise((function(t,n){l({tagName:e,reject:n,modules:c,error:"react-loading-libs-error",resolve:function(){l({tagName:e,reject:n,modules:s,error:"react-loading-dependencies-error",resolve:t})}})}))}(t.tagName,n,r,o,a,s).then((function(e){try{return t.appModule=e,t.render()}catch(e){throw d(t.tagName,"react-loader-render-func-error",{message:e.message,stack:e.stack}),e}})):Promise.reject(new Error("Module path not valid"))},s.prototype.deactivate=function(){this.appModule&&this.appModule.tags[this.tagName].destroy(this.element)},s.prototype.render=function(){var e=this.element,r=function(e){var t={};if(e.hasAttributes())for(var n=e.attributes,r=n.length-1;r>=0;r--)t[n[r].name]=n[r].value;return t}(e),i=function(e){var t,n,r,i={},o=[],a=[];for(Array.from(e.childNodes).forEach((function(t){if(1===t.nodeType){var n,r=[],i=t.tagName.toLowerCase();"template"===i?(r=Array.from(((n=t).content||n).children||[]),a.push(t)):r="ui-part"===i?[t]:Array.from(function(e){return e.getElementsByTagName("ui-part")}(e)),o=o.concat(r)}})),n=o.length-1;n>=0;n--)"ui-part"===(t=o[n]).tagName.toLowerCase()&&(r=t.innerHTML)&&(i[t.getAttribute("data-part-id")]=r);return a.forEach((function(t){e.removeChild(t)})),i}(e),s=this.tagName;!function(e){var t=Array.from(e.getElementsByTagName("span")),n=require("OK/LazyIconsCache");t.forEach((function(e){if(e.hasChildNodes()&&"svg"===e.firstChild.tagName){var t=e.getAttribute("data-icon-name");if(t){var r=n.getInstance(t);r.html||r.makeNode(e.innerHTML)}}}))}(e),e.addEventListener(o.INIT,(function(t){Object.assign(e,t.detail),e.setAttribute(a,"true"),e.dispatchEvent(new CustomEvent(o.READY,{bubbles:!1,cancelable:!1}))})),e.addEventListener(o.ACTIVATE,(function(e){n.activate(e.detail.element)})),e.addEventListener(o.DEACTIVATE,(function(e){var t=e.detail.element;n.deactivateOnlyElement?n.deactivateOnlyElement(t):n.deactivate(t)})),e.addEventListener(o.ERROR,(function(e){console.error(s,e.detail),t.error(s,e.detail)})),e.addEventListener(o.REACT_ERROR,(function(e){d(s,e.detail.code,e.detail.data)})),e.addEventListener(o.LOG,(function(e){t[e.detail.type].apply(t,e.detail.params||[])}));var c=this.appModule.tags[s];try{t.success("react-render-try",s,g(f()-this.activateStartTime)),c.render({tagName:s,attrs:r,parts:i,node:e}),t.success("react-render-success",s,g(f()-this.activateStartTime))}catch(e){d(s,"react-first-render-error",{message:e.message,stack:e.stack})}},s.onAppReady=function(e){return new Promise((function(t){e.getAttribute(a)?t(e):e.addEventListener(o.READY,(function(){t(e)}))}))},s.load=function(e,t,n){if(!document.head&&!document.body)throw new Error("DOM must be loaded");t([e],n,(function(e){n.error&&n.error(e)}))},s})),define("OK/react-tag-loader",["OK/webapi","OK/react-loader"],(function(e,t){"use strict";var n={};function r(e){this.name=e.name,this.js=e.js,this.bundleName=e.bundleName,this.css=e.css,this.pts=e.pts||[],this.pms=e.pms||[],this.requireModules=e.requireModules||[],this.attrsTypes=e.attrsTypes||{}}return{putTag:function(e){var t=new r(e);return n[e.name]=t,t},loadTag:function(t){var r=this;return n[t]?Promise.resolve(n[t]):e.invoke("react/tag",{name:t}).then((function(e){return r.putTag(e)}))},loadTags:function(t){var r=this,i=[],o=[];return t.forEach((function(e){n[e]?i.push(n[e]):o.push(e)})),o.length?e.invoke("react/tags",{names:o}).then((function(e){return i.concat(e.map((function(e){return r.putTag(e)})))})):Promise.resolve(i)},createElement:function(e,n,r,i){var o=document.createElement(e.name);o.setAttribute("data-react",e.js),e.css&&o.setAttribute("data-css",e.css),i&&Object.keys(i).forEach((function(e){o.setAttribute(e,JSON.stringify(i[e]))})),o.setAttribute("data-l10n",e.pts.join(",")),o.setAttribute("data-cfg",e.pms.join(",")),o.setAttribute("data-attrs-types",JSON.stringify(e.attrsTypes)),o.setAttribute("data-module","react-loader"),o.setAttribute("data-require-modules",e.requireModules.join(",")),o.classList.add("h-mod"),o.classList.add(e.bundleName);var a="";return n&&Object.keys(n).forEach((function(e){a+='<ui-part data-part-id="'+e+'">'+n[e]+"</ui-part>"})),a&&(a='<template style="display: none">'+a+"</template>",o.innerHTML=a),new Promise((function(e){var n=document.createElement("div");n.appendChild(o),require(["OK/capture"],(function(i){r&&r.appendChild(n),i.activate(n),t.onAppReady(o).then((function(){r?(r.appendChild(n.removeChild(o)),e(o)):e(n.removeChild(o)),n.remove()}))}))}))},getTag:function(t,n,r,i){var o=this,a=[this.loadTag(t)],s=[];return n&&(s=Object.keys(n)).forEach((function(t){a.push(e.invoke(n[t]))})),Promise.all(a).then((function(e){var t={};return s.forEach((function(n,r){t[n]=e[r+1]})),o.createElement(e[0],t,r,i)}))},deactivate:function(e){require(["OK/capture"],(function(t){t.deactivate(e)}))}}})),define("OK/AuthLoginPopup",["OK/react-tag-loader","OK/utils/debounce"],(function(e,t){"use strict";var n,r,i,o,a,s,c,l="auth-login-popup",u={capture:!0};function d(){var e=document.getElementsByTagName("auth-login-popup");return!!e&&(0!==e.length&&e[0].hasChildNodes())}var f={TAG_NAME:l,node:document.querySelector(l),open:function(t){if(f.node)f.node.open(t);else{var n=document.getElementById("hook_Block_LoginPopupReact");e.getTag(l,{"social-buttons":"login/getSocialLoginButtons"},n).then((function(e){f.node=e,e.open(t)}))}},closeIfOpened:function(){try{d()&&f.node&&f.node.close()}catch(e){}},openLayer:function(e){if(!d()){var t=function(e){var t="";return e.getAttribute("data-go-back-after-login")?t=window.location.pathname:"#"===(t=e.getAttribute("data-href")||e.getAttribute("href")||"")&&(t=""),t}(e),n=e.getAttribute("data-login-layer-text")||"",r=e.getAttribute("data-login-layer-registration-token")||"",i=e.getAttribute("data-login-layer-social-api-provider")||"",o=e.getAttribute("data-additional-stat-location")||"",a=e.getAttribute("data-show-close-as-button")||!1,s="true"===e.getAttribute("data-landing-page")||!1,c=e.getAttribute("data-login-show-profiles");c=null==c||"true"===c;var l=e.getAttribute("data-login-layer-header-image-conf");if(null!=l)try{l=JSON.parse(l)}catch(e){l=null}var u=e.getAttribute("data-login-hide-footer"),g={href:t,text:n,showProfiles:c,hideFooter:u=null!=u&&"true"===u,registrationToken:r,socialApiProvider:i,landing:s,contactOwnerExists:!1,contactOwnerRecoveryRequired:!1,showCloseAsButton:a,headerImage:l,additionalStatLocation:o};f.open(g)}},onClick:function(e){e.preventDefault();for(var t=e.target;t&&"AuthLoginPopup"!==t.getAttribute("data-module");)t=t.parentElement;t&&f.openLayer(t)},openLayerAfterDelay:function(e){a=setTimeout((function(){a=void 0,f.stateChanged()||f.openLayer(n)}),e)},repeatableOpener:function(){f.stateChanged()||(c>0&&(s=setTimeout(f.repeatableOpener,c)),a||d()||f.openLayerAfterDelay(c))},stateChanged:function(){return r!==OK.historyManager.getState()},onScroll:t(100,(function(e){if(!f.stateChanged()){var t=i&&document.querySelector(i)||document.documentElement,r=2*window.innerHeight;t.scrollTop>=r&&(window.removeEventListener("scroll",f.onScroll,u),f.openLayer(n),o&&o>0&&(c=o,s=setTimeout(f.repeatableOpener,o)))}})),activate:function(e){if(r=OK.historyManager.getState(),e.getAttribute("data-login-layer-autoopen-on-scroll"))n=e,window.addEventListener("scroll",f.onScroll,u),i=e.getAttribute("data-login-layer-autoopen-on-scroll-target-selector"),o=e.getAttribute("data-login-layer-autoopen-on-scroll-timeout-repeat");else if(e.getAttribute("data-login-layer-autoopen")){n=e;var t=e.getAttribute("data-login-layer-autoopen-timeout");t?(c=e.getAttribute("data-login-layer-autoopen-timeout-repeat"),f.openLayerAfterDelay(t),c&&c>0&&(s=setTimeout(f.repeatableOpener,c))):f.openLayer(e)}else e.addEventListener("click",f.onClick)},deactivate:function(e){e.getAttribute("data-login-layer-autoopen-on-scroll")||e.getAttribute("data-login-layer-autoopen")?(window.removeEventListener("scroll",f.onScroll,u),a&&(clearTimeout(a),a=void 0),s&&(clearTimeout(s),s=void 0),n=void 0):e.removeEventListener("click",f.onClick)}};return f})),define("OK/registration/socialSignIn",["OK/utils/utils","OK/utils/dom","OK/registration/socialAuthHandler","OK/AuthLoginPopup"],(function(e,t,n,r){"use strict";var i={url:"/dk",data:{cmd:"SocialSignIn"}};function o(t,n){return function(r){var o,a,s,c;"access_denied"!=r.error&&(o=r.code||"",a=r.error||"",s=r.id_token||"",c=r.user||"",i.data["s.sign.error"]=a,i.data["s.sign.code"]=o,i.data.id_token=s,i.data.user=c,i.data["s.sign.socialProvider"]=t,e.ajax(i).done(n.done).fail(n.fail))}}return{activate:function(e){var i=e.getAttribute("data-url"),a=e.getAttribute("data-provider"),s=e.getAttribute("data-error-field"),c=e.getAttribute("data-network-error"),l=t.firstByClass(document,s),u=600,d=600;"APPLE"===a&&(u=800,d=800),e.addEventListener("click",(function(e){l&&(l.innerHTML=""),n.openWindow(i,o(a,function(e,t){return{done:function(t,n,i){try{var o=JSON.parse(t);if(o.errorText&&e&&(e.innerHTML=o.errorText),o.redirectLocation)return void(document.location.href=o.redirectLocation);if(o.openLayerForSocialBind){var a={showProfiles:!0,hideFooter:!0,registrationToken:o.registrationToken,socialApiProvider:o.socialApiProvider,contactOwnerExists:o.contactOwnerExists,landing:o.landing,contactOwnerRecoveryRequired:o.contactOwnerRecoveryRequired,contactOwner:o.contactOwner,contactOwnerPhone:o.phoneNumber};r.closeIfOpened(),r.open(a)}}catch(e){}},fail:function(n,r,i){"Redirect"!=i&&e&&(e.innerHTML=t)}}}(l,c)),u,d),e.preventDefault()}))}}})),define("OK/registration/acceptPP",["OK/registration/Utils"],(function(e){"use strict";return{activate:function(t){var n=t.parentNode,r=n.getElementsByClassName("js-general-error")[0],i=t.getElementsByClassName("js-accept-pp-button")[0],o=e.getAttributesFromHook(t.getElementsByClassName("js-action-hook")[0],!0).action,a=t.getAttribute("data-type");i.addEventListener("click",(function(){var t={registrationAction:o};e.proceed(t,n,r,a)}))}}})),define("OK/PhoneForm",["OK/utils/vanilla","OK/utils/dom","OK/logger"],(function(e,t,n){"use strict";var r,i,o,a,s,c,l,u,d,f,g,p,v,h,m="data-",y="phoneValidationError";function b(){clearTimeout(p),v&&(v.abort(),v=void 0)}function C(e){i.classList.add("form_i__error"),a.textContent=e}function E(){i.classList.remove("form_i__error"),a.textContent=""}function O(t,r,i){if(b(),(L()+w()).length<5)return r&&r(),C(c["error-wrong-number"]),a="tooShort",s={phone:o.value,error:a},l=JSON.stringify(s),void n.success(y,l);var a,s,l,u=o.value;v=e.ajax({type:"GET",url:"/web-api/phoneinfo?phone="+encodeURIComponent(u)+"&service_name=odkl_registration&location=srv.check_phone_reg",dataType:"json"}).then((function(e){if(u==o.value){var n=e.response;if((n.modified_phone||n.modified_prefix)&&d(n.modified_phone,n.modified_prefix),n.ok)E(),t&&t();else{r&&r();var i=function(e){return e.charAt(0).toUpperCase()+e.slice(1)+"."},a=n.printable;if(a&&a.length>0){var s=i(a[0]);if(a.length>1)for(var l=1;l<a.length;l++)s+=" "+i(a[l]);C(s)}else C(c["error-wrong-number"])}}}),i).xhr}function w(){return o.value.replace("+","")}function L(){return r.value.replace("+","")}return{init:function(e){r=t.firstByClass(e,"js-country"),i=t.firstByClass(e,"js-phone-form"),o=t.firstByClass(e,"js-phone"),a=t.firstByClass(e,"js-ph-vl-hint");var n=t.firstByClass(e,"js-hook-serverside-phone-correction");if(n&&(c=function(e,t){"string"==typeof e&&(e=document.getElementById(e));for(var n={},r=0;r<e.attributes.length;r++){var i=e.attributes[r];if(0===i.name.indexOf(m)){var o=i.value;n[i.name.substring(m.length)]="false"!==o&&("true"===o||i.value)}}return t&&e.parentNode.removeChild(e),n}(n,!0)),c.enabled){s={};for(var v=0;v<r.options.length;v++){var y=r.options[v].value.replace("+","");void 0===s[y]&&(s[y]=v)}d=function(e,t){e&&(o.value=e,l=e),u!==t&&(u=t,r.selectedIndex=s[u.replace("+","")])},g=function(e){if(!h)for(var t=(e=e.replace("+","")).length;t>0;t--){var n=e.substring(0,t);if(void 0!==s[n]){n!==u.replace("+","")&&(r.selectedIndex=s[n],u=r[r.selectedIndex].value,r.dispatchEvent(new CustomEvent("prefixChange")));break}}},u=r.value}else(f=t.firstByClass(e,"js-phone-code")).addEventListener("click",o.focus);l=o.value;var C=function(){clearTimeout(p);var e=o.value.replace(/([^0-9+])/g,"").replace(/(^\+)|(\+)/g,"$1");(e!==o.value&&(o.value=e),o.value!==l)&&(l=o.value,g(o.value),o.value.replace("+","").length>=5?(b(),p=setTimeout(O,400)):E())},w=function(e){c.enabled?(o.value=r.value+o.value.replace("+","").substring(u.length-1,o.value.length),u=r.value,h=!e,C()):f.textContent=r.value};r.addEventListener("countryChange",(function(){w(!0)})),r.addEventListener("change",w),r.addEventListener("input",w),c.enabled&&o.addEventListener("input",C)},getCountryId:function(){return r.options[r.selectedIndex].getAttribute("data-id")},getCountryCodeIfNotInNumber:function(){return L()},getPhoneNumber:w,getPhoneInput:function(){return o}}})),define("OK/registration/enterPhoneNew",["OK/PhoneForm","OK/utils/dom"],(function(e,t){"use strict";return{activate:function(n){e.init(t.firstByClass(n,"js-phone-form"))}}})),define("OK/registration/enterCodeNew",["OK/utils/dom"],(function(e){"use strict";return{activate:function(t){var n=t.parentNode,r=e.firstByClass(n,"js-resend-sms-code-disabled"),i=e.firstByClass(n,"js-resend-sms-code"),o=e.firstByClass(n,"js-resend-sms-code_tx"),a=t.getAttribute("data-sms-wait-text"),s=parseInt(t.getAttribute("data-timer")),c=function(){var e=a.replace("%d",l);o.textContent=e};if(s>0){var l=Math.round(s/1e3);c(),r.classList.remove("invisible"),i.classList.add("invisible");var u=setInterval((function(){l<=1&&(clearInterval(u),r.classList.add("invisible"),i.classList.remove("invisible")),l--,c()}),1e3)}}}})),define("OK/registration/translit",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCyrToLatTransliteration=void 0;var n=[{" ":[" "],"-":["-"],"а":["a"],"б":["b"],"в":["v"],"г":["g"],"д":["d"],"е":["e","ye"],"ё":["yo","jo","e","ye"],"ж":["zh"],"з":["z"],"и":["i","yi"],"й":["j","jj","y","i"],"к":["k"],"л":["l"],"м":["m"],"н":["n"],"о":["o"],"п":["p"],"р":["r"],"с":["s"],"т":["t"],"у":["u"],"ф":["f"],"х":["x","kh","h","ch"],"ц":["cz","c","ts","tc"],"ч":["ch"],"ш":["sh"],"щ":["shh","shch"],"ъ":["''","'","ie"],"ы":["y'","y"],"ь":["'"],"э":["e'","eh","e"],"ю":["yu","ju","iu"],"я":["ya","ja","ia"]},{" ":[" "],"-":["-"],"а":["f"],"б":[","],"в":["d"],"г":["u"],"д":["l"],"е":["t"],"ё":["§"],"ж":[";"],"з":["p"],"и":["b"],"й":["q"],"к":["r"],"л":["k"],"м":["v"],"н":["y"],"о":["j"],"п":["g"],"р":["h"],"с":["c"],"т":["n"],"у":["e"],"ф":["a"],"х":["["],"ц":["w"],"ч":["x"],"ш":["i"],"щ":["o"],"ъ":["]"],"ы":["s"],"ь":["m"],"э":["'"],"ю":["."],"я":["z"]}];t.getCyrToLatTransliteration=function(e){var t=[];return n.forEach((function(n){for(var r,i,o=[],a=0;a<e.length;a++){var s=n[e.charAt(a).toLowerCase()];if(Array.isArray(s))if(a){var c=o.slice();o=[];for(var l=0;l<c.length;l++)for(r=0;r<s.length;r++)i=s[r],o.push(c[l]+i)}else o=s.slice()}t=t.concat(o)})),t}})),define("OK/registration/countryDropdown",["require","exports","doT","OK/utils/dom","OK/registration/translit","OK/utils/debounce"],(function(e,t,n,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deactivate=t.activate=void 0;var a,s,c,l,u,d,f,g,p={},v=!0,h=!1,m=n.template('{{? it.popularCountries.length || it.otherCountries.length}}{{?it.popularCountries.length}}{{?!it.filtered}}<div class="country-select_h">{{=it.locale.popularTitle}}</div>{{?}}{{~it.popularCountries : country}}<div class="country-select_i" data-name="{{=country.countryName}}"><div class="country-select_title ellip">{{=country.countryName}}</div>{{?country.countryCode}}<div class="country-select_code">{{=country.countryCode}}</div>{{?}}</div>{{~}}{{?}}{{?it.popularCountries.length && it.otherCountries.length && !it.filtered}}<div class="country-select_hr"></div>{{?}}{{?it.otherCountries.length}}{{?!it.filtered}}<div class="country-select_h">{{=it.locale.otherTitle}}</div>{{?}}{{~it.otherCountries : country}}<div class="country-select_i" data-name="{{=country.countryName}}"><div class="country-select_title ellip">{{=country.countryName}}</div>{{?country.countryCode}}<div class="country-select_code">{{=country.countryCode}}</div>{{?}}</div>{{~}}{{?}}{{?}}');function y(e){var t,n=e&&e.toLowerCase(),r=p.popularCountries.concat(p.otherCountries),i=a&&a.lastHighlighted||null;if(!e)return i?-1===(t=r.findIndex((function(e){return e.countryName===i})))&&(i=null,t=null):t=0,void(a={activeElementIndex:t,popularCountries:p.popularCountries,otherCountries:p.otherCountries,filtered:!1,lastHighlighted:i,locale:{popularTitle:f,otherTitle:g}});var o=[];r.forEach((function(e){for(var t=0,r=0;r<e.synonyms.length;r++){var i=e.synonyms[r],a=i.indexOf(n),s=0;-1!==a&&(0===a&&(s|=4,i===n&&(s|=8)),r||(s|=2),s|=1,t=Math.max(t,s))}t&&o.push({country:e,rank:t})})),o.sort((function(e,t){return t.rank-e.rank}));var s=o.map((function(e){return e.country}));-1===(t=s.findIndex((function(e){return e.countryName===i})))?t=null:i=s[t].countryName,a={activeElementIndex:t,popularCountries:[],otherCountries:s,filtered:!0,lastHighlighted:i,locale:{popularTitle:f,otherTitle:g}}}function b(){var e=m(a);c.innerHTML=e,s.classList.toggle("form_i__error",!e);var t=c.getElementsByClassName("country-select_i");if(t.length&&null!==a.activeElementIndex){var n=t[a.activeElementIndex];n.classList.add("__active"),a.lastHighlighted=n.getAttribute("data-name");var r=n.offsetTop,i=n.clientHeight,o=c.scrollTop,l=c.clientHeight;o>r&&(c.scrollTop=r),r>o+l-i&&(c.scrollTop=r-l+i),s.offsetHeight,s.className=s.className}else c.scrollTop=0}function C(e,t){if(e!==d){var n;for(d=e,l.value=e,n=0;n<u.options.length;n++)if(u.options[n].text===e){u.selectedIndex=n,u.dispatchEvent(new CustomEvent("countryChange"));break}if(a){var r=a.popularCountries.length;for(n=0;n<r;n++)if(a.popularCountries[n].countryName===e){a.activeElementIndex=n;break}for(n=0;n<a.otherCountries.length;n++)if(a.otherCountries[n].countryName===e){a.activeElementIndex=r+n;break}b()}}}function E(){return c.classList.contains("__active")}function O(){l.value=d,c.classList.remove("__active")}function w(){c.classList.add("__active")}function L(e){var t=r.parent(e.target,"country-select_i",null,!0);t&&(C(t.getAttribute("data-name")),O(),l.focus())}var A=o(100,(function(){y(l.value),w(),b()}));function k(){O(),a.lastHighlighted=d,s.classList.remove("form_i__error")}function T(){if(document.activeElement===c)return h=!0,void l.focus();h=!1,s.classList.remove("__focus"),k()}function x(){s.classList.add("__focus"),h||(y(),v&&(w(),b()),v=!0)}function K(){w(),b()}function N(){v=!1}function _(e){switch(e.key){case"Enter":if(E()){e.stopPropagation(),e.preventDefault();var t=a.popularCountries.length,n=a.otherCountries.length;null!==a.activeElementIndex&&(t||n)&&(a.activeElementIndex<t?C(a.popularCountries[a.activeElementIndex].countryName):C(a.otherCountries[a.activeElementIndex-t].countryName),a.lastHighlighted=d,y()),O()}break;case"Escape":case"Esc":k();break;case"ArrowDown":case"Down":e.preventDefault(),e.stopPropagation(),E()?null===a.activeElementIndex?a.activeElementIndex=0:a.activeElementIndex=(a.activeElementIndex+1)%(a.popularCountries.length+a.otherCountries.length):w(),b();break;case"ArrowUp":case"Up":e.preventDefault(),e.stopPropagation(),E()?null===a.activeElementIndex?a.activeElementIndex=a.popularCountries.length+a.otherCountries.length-1:a.activeElementIndex=a.activeElementIndex<1?a.popularCountries.length+a.otherCountries.length-1:a.activeElementIndex-1:w(),b()}}function j(){var e=window.pageYOffset+l.getBoundingClientRect().bottom,t=document.documentElement.scrollHeight-e-50;c.style.maxHeight=t+"px"}function B(){C(u.selectedOptions[0].textContent)}function S(e){e.preventDefault(),e.stopPropagation()}t.activate=function(e){s=e,l=r.firstByClass(e,"js-country-input"),u=r.firstByClass(e,"js-country"),d=l.value,f=l.getAttribute("data-popular-locale"),g=l.getAttribute("data-other-locale");try{p=JSON.parse(l.getAttribute("data-countries"))}catch(e){}var t;t=e.getAttribute("data-locale"),p.popularCountries?p.popularCountries.forEach((function(e){e.synonyms=[e.countryName.toLowerCase()],"ru"===t&&(e.synonyms=e.synonyms.concat(i.getCyrToLatTransliteration(e.countryName)))})):p.popularCountries=[],p.otherCountries?p.otherCountries.forEach((function(e){e.synonyms=[e.countryName.toLowerCase()],"ru"===t&&(e.synonyms=e.synonyms.concat(i.getCyrToLatTransliteration(e.countryName)))})):p.otherCountries=[],(c=document.createElement("div")).classList.add("country-select"),l.parentNode.insertBefore(c,null),j(),y(),b(),l.addEventListener("input",A),l.addEventListener("keydown",_),l.addEventListener("blur",T),l.addEventListener("focus",x),l.addEventListener("click",K),c.addEventListener("click",L),c.addEventListener("mousedown",S),u.addEventListener("prefixChange",B),window.addEventListener("resize",j),window.addEventListener("focus",N)},t.deactivate=function(){l.removeEventListener("input",A),l.removeEventListener("keydown",_),l.removeEventListener("blur",T),l.removeEventListener("focus",x),l.removeEventListener("click",K),c.removeEventListener("click",L),c.removeEventListener("mousedown",S),u.removeEventListener("prefixChange",B),window.removeEventListener("resize",j),window.removeEventListener("focus",N)}})),define("OK/registration/backhandler",[],(function(){"use strict";return{activate:function(e){!function(e){if(window.history){var t=e.getAttribute("data-stateid");history.pushState(t,null),window.addEventListener("load",(function(){setTimeout((function(){window.addEventListener("popstate",(function(e){e.state!==t&&(window.location.href="/dk?st.cmd=anonymBackHandler&st.returnState="+t)}))}),0)}))}}(e)}}})),define("OK/registration/vkconnect",["OK/registration/socialAuthHandler","OK/utils/dom","OK/utils/utils","OK/AuthLoginPopup"],(function(e,t,n,r){"use strict";var i,o,a,s,c,l,u,d;function f(e){var t={url:"/dk",data:{cmd:"SocialSignIn",payload:e,"s.sign.socialProvider":"VK_CONNECT"}};n.ajax(t).done((function(e,t,n){try{var i=JSON.parse(e);if(i.errorText&&d&&(d.innerHTML=i.errorText),i.redirectLocation)return void(document.location.href=i.redirectLocation);if(i.openLayerForSocialBind){var o={href:null,text:null,showProfiles:!0,hideFooter:!0,registrationToken:i.registrationToken,socialApiProvider:i.socialApiProvider,contactOwnerExists:i.contactOwnerExists,landing:i.landing,contactOwnerRecoveryRequired:i.contactOwnerRecoveryRequired,contactOwner:i.contactOwner,contactOwnerPhone:i.phoneNumber};r.closeIfOpened(),r.open(o)}}catch(e){}})).fail((function(e,t,n){"Redirect"!=n&&d&&(d.innerHTML=l)}))}function g(){e.openWindow(s,(function(e){"access_denied"!=e.error&&f(e.payload||"")}),800,800)}function p(e){f(JSON.stringify(e))}function v(){d&&u&&u.trim().length>0&&(d.innerHTML=u)}function h(e){e.onclick=function(e){d&&(d.innerHTML="");try{!function(){if("https:"!==location.protocol)return console.log("cannot use vk connect script without https"),void g();try{require([i],(function(e){var t={appId:o,appSettings:{external_device_id:a}};e.Config.init(t),e.Connect.userVisibleAuth().then(p,v)}),(function(e){console.log("vk script not loaded, proceed with fallback"),g()}))}catch(e){console.log("vk script not loaded, proceed with fallback"),g()}}()}catch(e){console.log("Exception while loading vk script, proceed with fallback"),g()}}}return{activate:function(e){!function(e){i=e.getAttribute("data-script-url"),o=e.getAttribute("data-app-id"),a=e.getAttribute("data-external-device-id"),s=e.getAttribute("data-url"),c=e.getAttribute("data-error-field"),l=e.getAttribute("data-network-error"),u=e.getAttribute("data-cancelled-error"),d=t.firstByClass(document,c)}(e),h(e)}}})),define("OK/registration/ChangedFieldValidator",[],(function(){"use strict";var e="form_i__error";function t(){}function n(e){return"radio"===e.type?e.checked.toString():e.value}return t.prototype.onChange=function(t){var r=t.target;this.element.classList.toggle(e,n(r)===r.getAttribute("data-initial-value"))},t.prototype.activate=function(t){(this.element=t,this.isErrorState=t.classList.contains(e),this.isErrorState)&&(Array.prototype.slice.call(t.getElementsByTagName("input")).forEach((function(e){e.setAttribute("data-initial-value",n(e))})),this.boundOnChange=this.onChange.bind(this),t.addEventListener("input",this.boundOnChange),t.addEventListener("change",this.boundOnChange))},t.prototype.deactivate=function(e){this.isErrorState&&(e.removeEventListener("input",this.boundOnChange),e.removeEventListener("change",this.boundOnChange))},t})),define("b/registration",["OK/registration/Registration","OK/registration/RegistrationDesign21","OK/registration/Utils","OK/registration/enterCode","OK/registration/chooseUser","OK/registration/authorize","OK/registration/socialSignIn","OK/registration/socialAuthHandler","OK/registration/acceptPP","OK/registration/enterPhoneNew","OK/registration/enterCodeNew","OK/registration/StatesManager","OK/registration/countryDropdown","OK/registration/translit","OK/registration/backhandler","OK/registration/vkconnect","OK/registration/ChangedFieldValidator"],{});
//# sourceMappingURL=/res/source-maps/js/b/registration.js.map